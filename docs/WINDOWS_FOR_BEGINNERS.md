# DMX Grabber: инструкция для Windows 10/11

Этот файл объясняет, как обработать PDF-файлы с DataMatrix и получить `CSV` без ручной настройки Python.

## 1. Что уже подготовлено в проекте

В проекте уже лежат нужные файлы:

- Установщик Python: `runtime\python-installer\python-3.14.3-amd64.exe`
- Библиотека DataMatrix: `runtime\libdmtx\libdmtx-64.dll`

## 2. Сначала: установить Python (если его нет в системе)

Перед первым запуском убедитесь, что Python установлен в Windows.
Если не уверены, просто установите его из файла:

1. Откройте папку `runtime\python-installer\`.
2. Запустите файл `python-3.14.3-amd64.exe`.
3. В окне установки:
   - включите галочку `Add python.exe to PATH`;
   - нажмите `Install Now`.
4. Дождитесь конца установки.
5. Запустите `run_windows.cmd`.

Если Python уже установлен, этот шаг не нужен.

## 3. Как пользоваться (обычный сценарий)

1. Если Python не установлен, сначала выполните раздел `2`.
2. Скопируйте ваш PDF-файл в папку `data\input\`.
3. Дважды кликните `run_windows.cmd`.
4. При первом запуске скрипт сам:
   - создаст `.venv` (виртуальное окружение);
   - поставит зависимости из `requirements.txt`.
5. Дождитесь окончания обработки.
6. Готовый файл будет здесь: `output\results.csv`.

## 4. Что делает скрипт автоматически

`run_windows.cmd` сам определяет:

- первый запуск это или повторный;
- нужно ли заново ставить зависимости;
- есть ли сохраненный прогресс после прерывания;
- нужно ли включить режим продолжения (`--resume`).

По умолчанию запуск идет с `4` воркерами (`-w 4`).

## 5. Если обработка прервалась

Если прошлый запуск был прерван (например, выключили ПК), скрипт увидит файл прогресса и спросит:

`Continue from saved progress? [Y/N]`

- Нажмите `Y`, чтобы продолжить с места остановки.
- Нажмите `N`, чтобы начать новую обработку.

## 6. Повторный запуск на новых PDF

Если `output\results.csv` уже есть, скрипт спросит:

`Delete old result before new run? [Y/N]`

- `Y`: удалить старый результат и создать новый.
- `N`: дописать новые коды в конец старого файла.

## 7. Как запустить с параметрами вручную (необязательно)

Если нужно, откройте терминал в папке проекта и используйте:

```bat
run_windows.cmd --resume
run_windows.cmd -w 8
run_windows.cmd --dpi 600
run_windows.cmd -i data\input -o output\my_result.csv -w 4
```

Важно: если вы явно передали `-w`, он переопределит дефолтные `4`.

## 8. Частые проблемы и решение

### Ошибка: `Python 3.10+ was not found`

Сделайте одно из двух:

1. Установите Python 3.11 для Windows.
2. Либо положите локальный Python сюда: `runtime\python\python.exe`.
3. Либо запустите встроенный установщик из `runtime\python-installer\`.

### Ошибка: `libdmtx runtime library is not available`

Положите DLL-файл библиотеки `libdmtx` в:

- `runtime\libdmtx\`
- или `runtime\libdmtx\bin\`

Пример имени: `libdmtx-64.dll`.

### Нет интернета, зависимости не ставятся

Для первого запуска нужен интернет, чтобы скрипт скачал Python-пакеты из `requirements.txt`.
